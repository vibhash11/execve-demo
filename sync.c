#include<stdio.h>
#include<unistd.h> /* fork() */
#include<stdlib.h>
#include<sys/types.h>
#include<sys/wait.h> /* wait() */
#include<errno.h>

int main(int argc,char *argv[]){
	
	int i=1,j=0;
	int status;
	char *myargv[1024];
	int pros=0;
	pid_t p;

	while(i<argc){
		/* creating argument array */
		j=0;
		myargv[j] = argv[i];
		do{			
			i+=1;
			j+=1;
			myargv[j] = argv[i];
		}while(i!=argc&&argv[i][0]=='-'); /* this loop will iterate if there are switches */
		myargv[j]=NULL;
		pros+=1;	
		
		/* child process will execute the program based on myargv[] */	
		p = fork();
		if(p==0)
		{	
			if(execve(myargv[0],myargv,NULL)==-1){
				perror("Exec Failed.");
				exit(1);
			}
		}
	}

	/* waiting for child processes to change state */
	for(i=1;i<=pros;i++){
		p = wait(&status);
		printf("pid of child = %d and status returned by it = %d\n",p,status);
	}
	return 0;
}
